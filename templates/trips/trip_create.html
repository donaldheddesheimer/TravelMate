{% extends "base.html" %}
{% load static %}

{% block title %}Add Trip - TravelMate{% endblock %}

{% block navbar %}
  <nav class="navbar navbar--alt">
    <div class="navbar__content">
      <div class="navbar__logo">
        <a href="{% url 'home:index' %}">TravelMate</a>
      </div>
      <div class="navbar__buttons">
        <!-- Your alternative buttons or links -->
        <a href="{% url 'accounts:login' %}" class="navbar__button">Alt Login</a>
      </div>
    </div>
  </nav>
{% endblock %}

{% block content %}
<div class="form-container">
  <h1>Add Trip</h1>
  <form method="POST" action="{% url 'trips:create' %}">
    {% csrf_token %}
    <div>
      <label for="destination">Destination</label>
      <input type="text" id="destination" name="destination" list="destinationOptions" placeholder="Enter destination" required>
      <datalist id="destinationOptions">
        <!-- Popular cities -->
        <option value="New York, USA">
        <option value="London, UK">
        <option value="Paris, France">
        <option value="Tokyo, Japan">
        <option value="Sydney, Australia">
        <option value="Rome, Italy">
        <option value="Barcelona, Spain">
        <option value="Berlin, Germany">
        <option value="Dubai, UAE">
        <option value="Singapore">
        <option value="Bangkok, Thailand">
        <option value="Los Angeles, USA">
        <option value="Las Vegas, USA">
        <option value="Miami, USA">
        <option value="San Francisco, USA">
        <option value="Chicago, USA">
      </datalist>
    </div>
    <div>
      <label for="date_leaving">Date Leaving</label>
      <input type="date" id="date_leaving" name="date_leaving" required>
    </div>
    <div>
      <label for="date_return">Date Returning</label>
      <input type="date" id="date_return" name="date_return" required>
    </div>
    <button type="submit" class="add-trip-button add-trip-button--glow">Create Trip</button>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const destinationInput = document.getElementById('destination');
    destinationInput.addEventListener('focus', function() {
      if (this.value === '') {
        this.placeholder = 'Start typing to see suggestions...';
      }
    });
    destinationInput.addEventListener('blur', function() {
      this.placeholder = 'Enter destination';
    });
  });
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector('form');
    const dateLeaving = document.getElementById('date_leaving');
    const dateReturn = document.getElementById('date_return');

    form.addEventListener('submit', function (e) {
      const today = new Date();
      const leavingDate = new Date(dateLeaving.value);
      const returnDate = new Date(dateReturn.value);

      today.setHours(0, 0, 0, 0);
      if (leavingDate < today) {
        alert("The departure date must be in the future.");
        e.preventDefault();
        return;
      }

      if (returnDate < leavingDate) {
        alert("The return date must be after the departure date.");
        e.preventDefault();
        return;
      }
    });
  });
</script>
{% endblock %}
